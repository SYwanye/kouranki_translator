
# 古朗基语转换表
kouranki_map = {
    # あ行
    'あ': 'が', 'い': 'ぎ', 'う': 'ぐ', 'え': 'げ', 'お': 'ご',
    'ア': 'ガ', 'イ': 'ギ', 'ウ': 'グ', 'エ': 'ゲ', 'オ': 'ゴ',
    
    # か行
    'か': 'ば', 'き': 'び', 'く': 'ぶ', 'け': 'べ', 'こ': 'ぼ',
    'カ': 'バ', 'キ': 'ビ', 'ク': 'ブ', 'ケ': 'ベ', 'コ': 'ボ',
    
    # が行
    'が': 'が', 'ぎ': 'ぎ', 'ぐ': 'ぐ', 'げ': 'げ', 'ご': 'ご',
    'ガ': 'ガ', 'ギ': 'ギ', 'グ': 'グ', 'ゲ': 'ゲ', 'ゴ': 'ゴ',
    
    # さ行
    'さ': 'が', 'し': 'ぎ', 'す': 'ぐ', 'せ': 'げ', 'そ': 'ご',
    'サ': 'ガ', 'シ': 'ギ', 'ス': 'グ', 'セ': 'ゲ', 'ソ': 'ゴ',
    
    # た行
    'た': 'ば', 'ち': 'び', 'つ': 'ぶ', 'て': 'べ', 'と': 'ぼ',
    'タ': 'バ', 'チ': 'ビ', 'ツ': 'ブ', 'テ': 'ベ', 'ト': 'ボ',
    
    # な行
    'な': 'ば', 'に': 'び', 'ぬ': 'ぶ', 'ね': 'べ', 'の': 'ぼ',
    'ナ': 'バ', 'ニ': 'ビ', 'ヌ': 'ブ', 'ネ': 'ベ', 'ノ': 'ボ',
    
    # は行
    'は': 'ざ', 'ひ': 'じ', 'ふ': 'ず', 'へ': 'ぜ', 'ほ': 'ぞ',
    'ハ': 'ザ', 'ヒ': 'ジ', 'フ': 'ズ', 'ヘ': 'ゼ', 'ホ': 'ゾ',
    
    # ま行
    'ま': 'ら', 'み': 'り', 'む': 'る', 'め': 'れ', 'も': 'ろ',
    'マ': 'ラ', 'ミ': 'リ', 'ム': 'ル', 'メ': 'レ', 'モ': 'ロ',
    
    # や行
    'や': 'じゃ', 'ゆ': 'じゅ', 'よ': 'じょ',
    'ヤ': 'ジャ', 'ユ': 'ジュ', 'ヨ': 'ジョ',
    
    # ら行
    'ら': 'さ', 'り': 'し', 'る': 'す', 'れ': 'せ', 'ろ': 'そ',
    'ラ': 'サ', 'リ': 'シ', 'ル': 'ス', 'レ': 'セ', 'ロ': 'ソ',
    
    # わ行
    'わ': 'ぽ', 'を': 'ぞ',
    'ワ': 'ポ', 'ヲ': 'ゾ',
    
    # 其他
    'ん': 'ん', 'ン': 'ン',
    
    # 濁音と半濁音
    'ざ': 'ざ', 'じ': 'じ', 'ず': 'ず', 'ぜ': 'ぜ', 'ぞ': 'ぞ',
    'ザ': 'ザ', 'ジ': 'ジ', 'ズ': 'ズ', 'ゼ': 'ゼ', 'ゾ': 'ゾ',
    
    'だ': 'ざ', 'ぢ': 'じ', 'づ': 'ず', 'で': 'ぜ', 'ど': 'ぞ',
    'ダ': 'ザ', 'ヂ': 'ジ', 'ヅ': 'ズ', 'デ': 'ゼ', 'ド': 'ゾ',
    
    'ば': 'ざ', 'び': 'じ', 'ぶ': 'ず', 'べ': 'ぜ', 'ぼ': 'ぞ',
    'バ': 'ザ', 'ビ': 'ジ', 'ブ': 'ズ', 'ベ': 'ゼ', 'ボ': 'ゾ',
    
    'ぱ': 'だ', 'ぴ': 'ぢ', 'ぷ': 'づ', 'ぺ': 'で', 'ぽ': 'ど',
    'パ': 'ダ', 'ピ': 'ヂ', 'プ': 'ヅ', 'ペ': 'デ', 'ポ': 'ド',
    
    # 特殊音
    'ファ': 'ザ',
}

def japanese_to_kouranki(japanese_text):
    """将日文转换为古朗基语"""
    result = []
    i = 0
    
    while i < len(japanese_text):
        char = japanese_text[i]
        
        # 处理长音
        if char == 'ー':
            if result:  # 如果结果不为空，重复前一个字符
                # 获取前一个字符的古朗基语转换
                prev_char = japanese_text[i-1]
                if prev_char in kouranki_map:
                    result.append(kouranki_map[prev_char][-1])  # 取最后一个假名
            i += 1
            continue
        
        # 处理促音
        elif char == 'っ' or char == 'ッ':
            # 查看下一个字符
            if i + 1 < len(japanese_text):
                next_char = japanese_text[i + 1]
                # 重复下一个字符的第一个假名
                if next_char in kouranki_map:
                    result.append(kouranki_map[next_char][0])
            i += 1
            continue
        
        # 处理普通字符
        elif char in kouranki_map:
            # 助詞の特殊変換
            if i > 0 and japanese_text[i-1] in ['は', 'が', 'の']:
                # は(助詞) -> パ
                if japanese_text[i-1] == 'は':
                    result.append('パ')
                # が(助詞) -> グ
                elif japanese_text[i-1] == 'が':
                    result.append('グ')
                # の(助詞) -> ン
                elif japanese_text[i-1] == 'の':
                    result.append('ン')
                i += 1
                continue
            result.append(kouranki_map[char])
        
        # 处理未在转换表中的字符（如拗音等）
        else:
            result.append(char)
        
        i += 1
    
    return ''.join(result)